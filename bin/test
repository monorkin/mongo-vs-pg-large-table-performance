#!/usr/bin/env ruby

require_relative "../lib/test"

puts
puts "=== TEST ==="
puts

test = Test.new
results = test.run

puts
puts "=== RESULTS ==="
puts

test_names = results.flat_map { |r| r.results.keys }.uniq.sort

test_names.each do |test_name|
  puts "= TEST: #{test_name} ="

  sorted_results = results.sort_by { |r| r.results[test_name] }

  smallest_value = sorted_results.first.results[test_name]
  sorted_results.each do |result|
    value = result.results[test_name]
    relative_value = (value / smallest_value).round(2) * 100.0 - 100.0

    puts "  #{result.name}: #{value} (+#{relative_value}%)"
  end
end
